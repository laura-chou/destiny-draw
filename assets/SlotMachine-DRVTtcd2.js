import{al as P,am as W,an as B,ao as a,ap as N,z as s,f as v,at as g,ar as p,aw as w,G as i,c as h,ay as T,az as A,aq as R}from"./index-DiTNGkJu.js";import{V as _,a as j,b as D,c as L,_ as q}from"./_plugin-vue_export-helper-CeApmRvS.js";import{V as E}from"./VDialog-CQBwlFGj.js";const G={class:"lucky-slot-wrapper"},I={class:"text-h4 font-weight-black text-white"},U=P({__name:"SlotMachine",setup(F){const b=A(),d=W(),c=i(),r=i(!1),u=i(""),l=i(!1),k=h(()=>typeof window<"u"?Math.min(window.innerWidth-65,400):400),m=h(()=>typeof window<"u"?Math.min(window.innerWidth-120,300)+"px":"270px"),y=[{padding:"10px",background:"#9c27b0"},{padding:"5px",background:"#4a148c"}],z={background:"#f3e5f5",fonts:[{fontSize:"18px",fontColor:"#4a148c",fontWeight:"bold"}]},x=h(()=>{const e=d.availablePrizes,t=[],f=Math.max(e.length,6);for(let o=0;o<f;o++){const n=e[o%e.length];t.push({fonts:[{text:(n==null?void 0:n.name)||"?",top:"35%"}],background:o%2===0?"#fff":"#f3e5f5",id:n==null?void 0:n.id})}return t}),V=[{speed:10},{speed:12},{speed:14}],C=()=>{l.value||(l.value=!0,c.value.play(),setTimeout(()=>{const e=Math.floor(Math.random()*x.value.length);c.value.stop([e,e,e])},2500))},S=e=>{l.value=!1;const t=Array.isArray(e)?e[0]:e;u.value=t.fonts[0].text,r.value=!0,d.recordWin(u.value,t.id)},M=()=>{r.value=!1,d.availablePrizes.length<2&&b.push("/settings")};return(e,t)=>{const f=T("SlotMachine",!0);return R(),B(N,{class:"d-flex flex-column align-center justify-center pa-0"},{default:a(()=>[s(_,{class:"mx-auto pa-4 pa-sm-6 slot-outer-card",elevation:"20",rounded:"xl","max-width":k.value},{default:a(()=>[v("div",G,[s(f,{ref_key:"myLucky",ref:c,width:m.value,height:m.value,prizes:x.value,blocks:y,slots:V,defaultStyle:z,onEnd:S},null,8,["width","height","prizes"])]),s(g,{class:"mt-4 mt-sm-8 play-btn text-white font-weight-black",color:"purple-accent-4",size:"x-large",onClick:C,disabled:l.value,block:"",rounded:"pill"},{default:a(()=>[p(w(l.value?"請稍後...":"拉霸"),1)]),_:1},8,["disabled"])]),_:1},8,["max-width"]),s(E,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=o=>r.value=o),"max-width":"320",persistent:""},{default:a(()=>[s(_,{class:"rounded-xl pa-4 result-card"},{default:a(()=>[s(j,{class:"text-center text-h5 font-weight-bold text-purple-accent-1"},{default:a(()=>[...t[1]||(t[1]=[p("恭喜",-1)])]),_:1}),s(D,{class:"text-center py-6"},{default:a(()=>[v("div",I,w(u.value),1)]),_:1}),s(L,{class:"justify-center"},{default:a(()=>[s(g,{color:"purple-accent-4",variant:"elevated",size:"large",rounded:"pill",width:"160",onClick:M},{default:a(()=>[...t[2]||(t[2]=[p("確定",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),O=q(U,[["__scopeId","data-v-2ad967eb"]]);export{O as default};
